{"version":3,"sources":["app/scripts/index.jsx"],"names":[],"mappings":"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","file":"app/scripts/index.jsx","sourcesContent":["'use strict';\nvar PEER_API_KEY = 'qfsyx0jzn7xbhuxr';\n\nvar STATE = {\n  INITIAL: 0,\n  PRESENTING: 1,\n  WAITING_FOR_CALL: 2,\n}\n\n$(document).ready(function() {\n\n  var TabSwitcher = React.createClass({\n    propTypes: {\n      tabs: React.PropTypes.arrayOf(React.PropTypes.shape({\n        title: React.PropTypes.string,\n        src: React.PropTypes.string,\n        tagline: React.PropTypes.string\n      })),\n      tabIndex: React.PropTypes.number\n    },\n    render: function() {\n      var tabs = this.props.tabs.map((tab, i) => {\n        // @TODO(shrugs) - autoPlay on this video or no?\n        return (\n          <div style={{\n            margin: '20px',\n            height: '30vh',\n            maxWidth: '34%',\n            textAlign: 'center',\n            flexGrow: '1',\n            position: 'relative'\n          }} key={i}>\n            <video src={tab.src} style={{\n              width: '75%',\n              borderRadius: '5px',\n              border: this.props.tabIndex === i ? '4px solid white' : 'none'\n            }}></video>\n            <h1 style={{\n              marginTop: this.props.tabIndex === i ? '1px' : '4px',\n              marginBottom: '2px'\n            }}>{tab.title}</h1>\n            <p style={{\n              marginTop: '5px',\n              marginBottom: '0'\n            }}>{tab.tagline}</p>\n          </div>\n        );\n      });\n      return (\n        <div style={{\n          position: 'absolute',\n          width: '100vw',\n          height: '100vh',\n          display: 'flex',\n          flexDirection: 'column',\n          flexWrap: 'nowrap',\n          justifyContent: 'center',\n          alignContent: 'flex-start',\n          alignItems: 'center'\n        }}>\n          <div style={{\n            width: '100vw',\n            height: '40vh',\n            backgroundColor: 'rgb(41, 174, 255)',\n            color: 'white',\n            display: 'flex',\n            flexDirection: 'row',\n            flexWrap: 'nowrap',\n            justifyContent: 'center',\n            alignContent: 'flex-start',\n            borderRadius: '5px',\n            alignItems: 'center'\n          }}>\n            {tabs}\n          </div>\n        </div>\n      );\n    }\n  });\n\n  var App = React.createClass({\n\n    getInitialState: function() {\n\n      key('ctrl+tab', () => {\n        // @TODO(shrugs) - show list of friends\n        if (this.state.tabTimer !== undefined) {\n          // increment the thing and reset the timer\n          clearTimeout(this.state.tabTimer);\n          this.startTabTimer();\n          this.setState({\n            tabIndex: (this.state.tabIndex + 1) % this.state.CALLS.length\n          });\n        } else {\n          this.startTabTimer();\n          this.setState({\n            tabIndex: this.state.CALLS.length > 1 ? (this.state.tabIndex + 1) % this.state.CALLS.length : 0\n          });\n        }\n      });\n\n      return {\n        state: STATE.INITIAL,\n        tabTimer: undefined,\n        tabIndex: 0,\n        activeStream: undefined,\n        room: 'Hack the Planet',\n        CALLS: [\n          // {\n          //   url: 'test',\n          //   metadata: {title: 'My Title', tagline: 'My tagline'},\n          //   call: {}\n          // },\n          // {\n          //   url: 'test',\n          //   metadata: {title: 'Project 2', tagline: 'My tagline'},\n          //   call: {}\n          // }\n        ]\n      };\n    },\n\n    /*\n      TAB TIMER\n    */\n    startTabTimer: function() {\n      this.setState({\n        tabTimer: setTimeout(this.onTabTimerEnd, 600)\n      });\n    },\n\n    onTabTimerEnd: function() {\n      clearTimeout(this.state.tabTimer);\n      this.setState({\n        tabTimer: undefined,\n        activeStream: this.state.tabIndex\n      });\n    },\n\n\n    /*\n      ROOM HANDLING\n    */\n    createRoom: function(e) {\n      this.setState({\n        state: STATE.WAITING_FOR_CALL\n      });\n\n      var peer = new Peer(this.state.room, {key: PEER_API_KEY});\n\n      peer.on('call', (call) => {\n        // immediately answer call\n        call.answer();\n        call.on('stream', (remoteStream) => {\n          // store the stream url in CALLS, along with metadata\n          this.setState({\n            state: STATE.PRESENTING,\n            CALLS: this.state.CALLS.concat({\n              url: window.URL.createObjectURL(remoteStream),\n              metadata: call.metadata,\n              call: call\n            }),\n            activeStream: !this.state.CALLS.length ? 0 : this.state.activeStream\n          });\n\n        }, function(e) {\n          debugger;\n        });\n        call.on('close', () => {\n          console.log('CONNECTION CLOSED');\n          // remove from CALLS\n          this.setState({\n            CALLS: this.state.CALLS.filter((c) => {\n              return c.call.peer !== call.peer;\n            })\n          });\n\n          if (!this.state.CALLS.length) {\n            this.setState({\n              state: STATE.WAITING_FOR_CALL\n            });\n          }\n        });\n      });\n    },\n\n    onRoomChange: function(e) {\n      this.setState({\n        room: e.target.value\n      });\n    },\n\n    render: function() {\n      var r = [];\n\n      if (this.state.state === STATE.INITIAL) {\n\n        r.push (\n          <div key=\"initial\">\n            <img className=\"logo\" src=\"images/logo.png\"></img>\n            <h1 className=\"diamond\">diamond</h1>\n\n            <form>\n              <div>\n                <label htmlFor=\"room\">\n                  <h2 style={{marginBottom: '6px'}}>Event</h2>\n                </label>\n                <input onChange={this.onRoomChange} value={this.state.room} defaultValue=\"Hack the Planet\" type=\"text\" name=\"room\"></input>\n              </div>\n            </form>\n            <button className=\"submit-button\" onClick={this.createRoom}>\n              <h2 style={{marginTop: '5px'}}>Step up!</h2>\n            </button>\n          </div>\n        );\n      } else if (this.state.state === STATE.WAITING_FOR_CALL) {\n        r.push (\n          <div key=\"waiting\" style={{textAlign: 'center', fontSize: '6vw'}}>\n            <h3>Join Room</h3>\n            <h1>{this.state.room}</h1>\n          </div>\n        );\n      } else if (this.state.state === STATE.PRESENTING) {\n\n        if (this.state.tabTimer !== undefined) {\n          var tabs = this.state.CALLS.map((c) => {\n            return {\n              title: c.metadata.title,\n              src: c.url,\n              tagline: c.metadata.tagline\n            };\n          })\n          r.push(<TabSwitcher key=\"tabSwitcher\" tabIndex={this.state.tabIndex} tabs={tabs}></TabSwitcher>);\n        }\n\n        var src = this.state.CALLS[this.state.activeStream].url;\n        r.push (\n          <div key=\"presenting\" style={{\n            backgroundColor: '#000',\n            height: '100vh',\n            display: 'flex',\n            flexDirection: 'column',\n            flexWrap: 'nowrap',\n            justifyContent: 'center',\n            alignContent: 'flex-start',\n            alignItems: 'center'\n          }}>\n            <video className=\"video\" src={src} autoPlay></video>\n          </div>\n        );\n      }\n\n      return (\n        <div>{r}</div>\n      );\n    }\n\n  });\n\n  React.render(<App></App>, document.getElementById('main'));\n});\n"]}